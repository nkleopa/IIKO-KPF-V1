Описание ошибок

  

    

   

  
  

  

Любой метод серверного REST API v1 и REST API v2 вместо ответа в  задокументированном формате может вернуть одну из следующих ошибок с  телом text/plain:

HTTP code

Значение, описание, параметры

Ожидаемое поведение клиента/интеграции

	403	
Доступ запрещён (аутентифицирован, но нет прав):
На сервере нет лицензии на данный API или подсистему API (сотрудников, событий...)
(Module %s is blocked within current license)
Превышено разрешенное количество подключений к API или подсистеме API
(License enhancement is required: no connections available for module %s)
У вошедшего пользователя нет прав, требуемых конкретным модулем API
(Permission denied)	Уведомить пользователя (внимание: текст ошибки не локализован) 
	400	
Либо ошибка в запросе (параметры не того типа, ошибки  десериализации), либо внутренняя ошибка, связанная с неполнотой  полученных в запросе, либо хранящихся в базе данных:
Wrong date format: 2019-0513 15:26
Malformed Product id: ''
Argument for @NotNull parameter 'arg' of resto/TestNotNullValidation.methodWithNotNullArg must not be null 	List<String>
	401	
Не аутентифицирован:
не передан параметр key в запросе или в cookie
истек  таймаут сессии (обычно 1 час) с момента входа или момента последнего  запроса, если работает "обновление токена" (не реализовано в REST API  v1/v2)
сервер iikoRMS/iikoChain был перезагружен
сервер iikoRMS/iikoChain находится в процессе (пере)запуска и не может проверить пароль 	List<ProductType>
	404
	
Объект не найден, некорректный путь	
Уведомить пользователя или автора клиента/интеграции.
	409
	
Произошла ошибка бизнес-логики, сервер вернул сообщение для пользователя:
"Доступ запрещен КОД_ПРАВА"
"Операция создает приход на отрицательные остатки..."
"У вас нет права изменять документы задним числом."
"Невозможно создать накладную со складами, принадлежащими разным подразделениям."
... и сотни других	Уведомить пользователя и показать ему текст ошибки

	500
	
Произошла внутренняя ошибка:

User represents store, but no linked store found: %s

Unknown client type for outgoing invoice: %s

Operation is allowed only in %s's thread. Current thread: %s

Operation is not allowed in %s's thread

No session assigned to current thread
java.net.SocketException: Connection reset
product == null
One product expected for article=%s but %d found: %s
Invalid key for item, expected: %s but was: %s
... тысячи их	Уведомить пользователя или автора клиента/интеграции. Может потребоваться обращение в техподдержку iiko.
 
1)Получить кол-во свободных слотов для конкретного лицензионного модуля можно запросом http://localhost:8080/resto/api/licence/info?moduleId=28008806
Все тело ответа в формате Content-type: text/plain является текстом ошибки, который рекомендуется вывести пользователю (при получении статуса 409)  и записать в свой лог для упрощения поддержки (при получении любого  http-статуса). Тип ответа, содержащий html (text/html, text/xhtml и  т.п), говорит о сетевой ошибке или ошибке настройки сервера (опечатка в  URL, ошибка DNS, ошибка настроек прокси, "пустой" Tomcat без сервера  RMS/Chain и т.п.), реже о рестарте сервера.
Если выше не указано  явно (в частности, код 409), текст ошибки не локализован и может  содержать технические детали (UUID-ы затронутых объектов).
Текст может содержать обязательные переносы строк, то есть, рассчитан на вывод в режиме CSS "white-space: pre-line;".
Текст не экранирован и может содержать "опасные" для js, html, sql, etc символы.
Лог  сервера (full.log, access.csv) может содержать больше информации, чем  доступно пользователю API. Это включает в себя не только детали  произошедших ошибок/отказов, но и "предупреждений" (WARN).
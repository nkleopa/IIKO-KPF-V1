Выгрузка приходной накладной по ее номеру

  

    

  
Параметры запроса
Что в ответе
Пример запроса и результат 

  
  

  

Версия iiko: 5.4
  
    
	                	
        
        
        
https://host:port/resto/api/documents/export/incomingInvoice/byNumber
      
      
    
  

Параметры запроса

  
    

      
        
           Название         
      
      
        
           Значение         
      
      
        
           Описание         
      
    
  
  
    

      	
        number
      
      	         String       
      	         номер документа       
    
    

      	
        from
      
      	         YYYY-MM-DD       
      	         начальная дата (входит в интервал)       
    
    

      	
        to
      
      	         YYYY-MM-DD       
      	         конечная дата (входит в интервал, время не учитывается)       
    
    

      	
        currentYear
      
      	         Boolean       
      	         только за текущий год       
    
  

   При currentYear = true, вернет документы с указанным номером документа только за текущий год. Параметры from и to должны отсутствовать. 

   При currentYear = false параметры from и to должны быть указаны. 

   currentYear — обязательный параметр. 

  Что в ответе 

  

    [+]
    
      XSD Приходная накладная
    
  
  

    [-]
    
      XSD Приходная накладная
    
  
  

     
	
Copy Code
XML
	<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="document" type="incomingInvoiceDto"/>
 
    <xs:complexType name="incomingInvoiceDto">
        <xs:sequence>
            <!--Позиции документа-->
            <xs:element name="items" minOccurs="0">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="item" type="incomingInvoiceItemDto" minOccurs="0" maxOccurs="unbounded"/>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
            <!--
            Id документа (только чтение)
            @since 5.4
            -->
            <xs:element name="id" type="xs:string" minOccurs="0"/>
            <!--Концепция (guid)-->
            <xs:element name="conception" type="xs:string" minOccurs="0"/>
            <!--
            Код концепции.
            @since 7.8
            -->
            <xs:element name="conceptionCode" type="xs:string" minOccurs="0"/>
            <!--Комментарий-->
            <xs:element name="comment" type="xs:string" minOccurs="0"/>
            <!--Учетный номер документа-->
            <xs:element name="documentNumber" type="xs:string" minOccurs="0"/>
            <!--
            Дата документа.
            Поддерживаемые форматы:
            yyyy-MM-ddTHH:mm:ss, yyyy-MM-dd (dd.MM.yyyy не рекомендуется).
            -->
            <xs:element name="dateIncoming" type="xs:string" minOccurs="0"/>
            <!--Номер счет-фактуры.-->
            <xs:element name="invoice" type="xs:string" minOccurs="0"/>
            <!--Склад. Если указан, то в каждой позиции накладной нужно указать этот же склад.-->
            <xs:element name="defaultStore" type="xs:string" minOccurs="0"/>
            <!--Поставщик-->
            <xs:element name="supplier" type="xs:string" minOccurs="0"/>
            <!--
            Срок оплаты.
            Поддерживаемые форматы:
            yyyy-MM-ddTHH:mm:ss (dd.MM.yyyy не рекомендуется)
            -->
            <xs:element name="dueDate" type="xs:string" minOccurs="0"/>
            <!--
            Входящая дата внешнего документа в формате yyyy-MM-dd.
            Если при импорте не указана, то берется из dateIncoming.
            @since 7.6.1
            -->
            <xs:element name="incomingDate" type="xs:string" minOccurs="0"/>
            <!--
            false (по умолчанию): использовать переданные дату-время dateIncoming как есть.
            true: использовать настройки проведения документов, заданные в подразделении:
             * В режиме "текущее время" - дату и время из dateIncoming;
             * "фиксированное время" или "время закрытия кассовой смены" - дату из dateIncoming, а время из настроек.
            @since 5.2
            -->
            <xs:element name="useDefaultDocumentTime" type="xs:boolean" minOccurs="0" default="false"/>
            <xs:element name="status" type="documentStatus" minOccurs="0"/>
            <!--Входящий номер внешнего документа-->
            <xs:element name="incomingDocumentNumber" type="xs:string" minOccurs="0"/>
            <!--Сотрудник (поле "зачесть сотруднику" на форме накладной)-->
            <xs:element name="employeePassToAccount" type="xs:string" minOccurs="0"/>
            <!--Номер товарно-транспортной накладной-->
            <xs:element name="transportInvoiceNumber" type="xs:string" minOccurs="0"/>
            <!--
            UUID связанной расходной накладной
            (только чтение)
            @since 5.4
            -->
            <xs:element name="linkedOutgoingInvoiceId" type="xs:string" minOccurs="0"/>
             
            <!--
            Алгоритм распределения дополнительных расходов.
            (только чтение)
            @since 6.0
            -->
            <xs:element name="distributionAlgorithm" type="distributionAlgorithmType" minOccurs="0"/>
        </xs:sequence>
    </xs:complexType>
 
    <!--Позиция документа-->
    <xs:complexType name="incomingInvoiceItemDto">
        <xs:sequence>
            <!--
            Является дополнительным расходом
            (только чтение)
            @since 6.0
            -->
            <xs:element name="isAdditionalExpense" type="xs:boolean" minOccurs="0" default="false"/>
             <!--Количество товара в его основных единицах измерения-->
            <xs:element name="amount" type="xs:decimal" minOccurs="0"/>
            <!--Товар у поставщика (guid)-->
            <xs:element name="supplierProduct" type="xs:string" minOccurs="0"/>
            <!--Товар у поставщика (артикул). Можно задать вместо guid начиная с 5.0.-->
            <xs:element name="supplierProductArticle" type="xs:string" minOccurs="0"/>
            <!--Товар (guid). Хотя бы одно из полей должно быть заполнено: product или productArticle.-->
            <xs:element name="product" type="xs:string" minOccurs="0"/>
            <!--Товар (артикул). Можно задать вместо guid товара начиная с 5.0, guid имеет приоритет.-->
            <xs:element name="productArticle" type="xs:string" minOccurs="0"/>
            <!--Производитель/импортер. Должен содержаться в списке производителей/импортеров в карточке товара:
            Товар - Дополнительная информация - Акогольная декларация - Производитель/Импортер-->
            <xs:element name="producer" type="xs:string" minOccurs="0"/>
            <!--Номер позиции в документе. Обязательное поле.-->
            <xs:element name="num" type="xs:int" minOccurs="1"/>
            <!--Фасовка (guid)-->
            <xs:element name="containerId" type="xs:string" minOccurs="0"/>
            <!--Базовая единица измерения (guid)-->
            <xs:element name="amountUnit" type="xs:string" minOccurs="0"/>
            <!--Вес единицы измерения-->
            <!--!!! Не реализовано !!!-->
            <xs:element name="actualUnitWeight" type="xs:decimal" minOccurs="0"/>
            <!--
            Cумма строки без учета скидки.
            Как правило sum == amount * price / container + discountSum + vatSum
             -->
            <xs:element name="sum" type="xs:decimal" minOccurs="1"/>
            <!--Cумма скидки-->
            <!--!!! Не реализовано !!!-->
            <xs:element name="discountSum" type="xs:decimal" minOccurs="0"/>
            <!--
            Величина процента НДС и сумма НДС для строки документа.
            Если не задана сумма, она вычисляется по проценту.
            Если не задан процент, он берется из карточки товара.
            Нельзя задать только сумму, не задавая процент.
            @since 5.0
            -->
            <xs:element name="vatPercent" type="xs:decimal" minOccurs="0"/>
            <xs:element name="vatSum" type="xs:decimal" minOccurs="0"/>
            <!--Цена единицы измерения-->
            <xs:element name="priceUnit" type="xs:string" minOccurs="0"/>
            <!--Цена за ед.-->
            <xs:element name="price" type="xs:decimal" minOccurs="0"/>
            <!--
            Цена без НДС за фасовку с учетом скидки
            @since 6.2
            -->
            <xs:element name="priceWithoutVat" type="xs:decimal" minOccurs="0"/>
            <!--Код-->
            <!--!!! Не реализовано !!!-->
            <xs:element name="code" type="xs:string" minOccurs="0"/>
            <!--Склад-->
            <xs:element name="store" type="xs:string" minOccurs="0"/>
            <!--Номер государственной таможенной декларации-->
            <xs:element name="customsDeclarationNumber" type="xs:string" minOccurs="0"/>
            <!--Фактическое (подтвержденное) количество основных единиц товара-->
            <xs:element name="actualAmount" type="xs:decimal" minOccurs="0"/>
        </xs:sequence>
    </xs:complexType>
 
    <xs:simpleType name="documentStatus">
        <xs:restriction base="xs:string">
            <xs:enumeration value="NEW"/>
            <xs:enumeration value="PROCESSED"/>
            <xs:enumeration value="DELETED"/>
        </xs:restriction>  
    </xs:simpleType>
     
    <xs:simpleType name="distributionAlgorithmType">
        <xs:restriction base="xs:string">
            <xs:enumeration value="DISTRIBUTION_BY_SUM"/>
            <xs:enumeration value="DISTRIBUTION_BY_AMOUNT"/>
            <xs:enumeration value="DISTRIBUTION_NOT_SPECIFIED"/>
        </xs:restriction>
    </xs:simpleType>
</xs:schema>
  

  Пример запроса и результат 

  Запрос 

   https://localhost:9080/resto/api/documents/export/incomingInvoice/byNumber?key=49023c7b-86f4-351a-b237-554a674bf3a9&number=1711&from=2012-01-01&to=2012-12-30&currentYear=false

  

    [+]
    
      Результат
    
  
  

    [-]
    
     Результат
    
  
  

     
	
Copy Code
XML
	<incomingInvoiceDtoes>
    <document>
        <id>f12649c3-d340-4e61-9bbd-5ca2ac644636</id>
        <incomingDocumentNumber>1019</incomingDocumentNumber>
        <incomingDate>2012-07-14T08:00:00</incomingDate>
        <useDefaultDocumentTime>false</useDefaultDocumentTime>
        <dueDate>2012-07-15T00:00:00</dueDate>
        <supplier>e78e3868-1272-494e-80dc-190ec63a7fc1</supplier>
        <defaultStore>1239d270-1bbe-f64f-b7ea-5f00518ef508</defaultStore>
        <invoice/>
        <documentNumber>1711</documentNumber>
        <comment>РЅ</comment>
        <status>PROCESSED</status>
        <items>
            <item>
                <actualAmount>1.000000000</actualAmount>
                <store>1239d270-1bbe-f64f-b7ea-5f00518ef508</store>
                <code>07001</code>
                <price>500.000000000</price>
                <sum>500.000000000</sum>
                <vatPercent>0.000000000</vatPercent>
                <vatSum>0.000000000</vatSum>
                <discountSum>0.000000000</discountSum>
                <amountUnit>cd19b5ea-1b32-a6e5-1df7-5d2784a0549a</amountUnit>
                <num>3</num>
                <product>28f786de-a835-42d5-9c18-84dd5de72e1c</product>
                <productArticle>07001</productArticle>
                <amount>1.000000000</amount>
            </item>
            <item>
                <actualAmount>30.000000000</actualAmount>
                <store>1239d270-1bbe-f64f-b7ea-5f00518ef508</store>
                <code>00103</code>
                <price>64.000000000</price>
                <sum>1920.000000000</sum>
                <vatPercent>0.000000000</vatPercent>
                <vatSum>0.000000000</vatSum>
                <discountSum>0.000000000</discountSum>
                <amountUnit>69859c74-db72-b006-cba5-326cf6f4fc6e</amountUnit>
                <num>1</num>
                <product>f919d569-01c6-4593-a5cf-457a384b9165</product>
                <productArticle>00103</productArticle>
                <amount>30.000000000</amount>
            </item>
            <item>
                <actualAmount>30.000000000</actualAmount>
                <store>1239d270-1bbe-f64f-b7ea-5f00518ef508</store>
                <code>00102</code>
                <price>69.000000000</price>
                <sum>2070.000000000</sum>
                <vatPercent>0.000000000</vatPercent>
                <vatSum>0.000000000</vatSum>
                <discountSum>0.000000000</discountSum>
                <amountUnit>69859c74-db72-b006-cba5-326cf6f4fc6e</amountUnit>
                <num>2</num>
                <product>8f8b5673-0a54-49c8-8eac-f5f9c5edcb02</product>
                <productArticle>00102</productArticle>
                <amount>30.000000000</amount>
            </item>
        </items>
    </document>
</incomingInvoiceDtoes>